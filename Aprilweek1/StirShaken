{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from pymongo import MongoClient\n",
    "from datetime import datetime\n",
    "import json\n",
    "from pandas import json_normalize\n",
    "import glob\n",
    "import os\n",
    "import numpy as np\n",
    "import warnings\n",
    "import matplotlib.pyplot as plt\n",
    "import pyodbc\n",
    "\n",
    "warnings.filterwarnings(\"ignore\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "client = MongoClient(\"mongodb://voip-iss:vP-JneR8db@172.16.110.145:27017,172.16.110.147:27017,172.17.110.145:27017/voip-iss?retryWrites=true&loadBalanced=false&replicaSet=rs0&readPreference=primary&connectTimeoutMS=10000&authSource=admin&authMechanism=SCRAM-SHA-1\")\n",
    "database = client['voip-iss']\n",
    "collection = database['httpLog']\n",
    "\n",
    "query = {\n",
    "    \"$and\": [\n",
    "        {\"http_info.status\": {\"$ne\": 200}},\n",
    "        {\"date_time\": {\"$gte\": datetime(2024, 4, 1, 0, 0, 0), \"$lt\": datetime(2024, 4, 8, 0, 0, 0)}}\n",
    "    ]\n",
    "}\n",
    "\n",
    "result = list(collection.find(query))\n",
    "df = pd.DataFrame(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "pd.options.display.float_format='{:.0f}'.format"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "http_info_df = pd.json_normalize(df['http_info'])\n",
    "df = pd.concat([df, http_info_df], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>_id</th>\n",
       "      <th>cid</th>\n",
       "      <th>plugin</th>\n",
       "      <th>http_info</th>\n",
       "      <th>time_start</th>\n",
       "      <th>time_stop</th>\n",
       "      <th>time_seg</th>\n",
       "      <th>date_time</th>\n",
       "      <th>error</th>\n",
       "      <th>request</th>\n",
       "      <th>response</th>\n",
       "      <th>status</th>\n",
       "      <th>reason</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>66136b66ff2cdc8c8171adb9</td>\n",
       "      <td>3698400ef55c11eea80c70df2faec9db</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548710</td>\n",
       "      <td>1712548710</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:58:30.187</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>66136ad04969eb4816301e43</td>\n",
       "      <td>e9570956f55b11ee934a0050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548560</td>\n",
       "      <td>1712548560</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:56:00.132</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>66136aadff2cdc8c8171abb0</td>\n",
       "      <td>d48a5942f55b11eea7ca005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548525</td>\n",
       "      <td>1712548525</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:55:25.232</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>661369924969eb481630171d</td>\n",
       "      <td>2c1e72def55b11ee92b40050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1712548243</td>\n",
       "      <td>1712548243</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:50:42.699</td>\n",
       "      <td>None</td>\n",
       "      <td>\"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>661369904969eb481630170f</td>\n",
       "      <td>2afac18cf55b11ee92b40050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1712548241</td>\n",
       "      <td>1712548241</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:50:40.840</td>\n",
       "      <td>None</td>\n",
       "      <td>\"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12196</th>\n",
       "      <td>660a38874969eb481653c1a2</td>\n",
       "      <td>a6150042efe011ee8339005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:31:03.370</td>\n",
       "      <td>None</td>\n",
       "      <td>\"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12197</th>\n",
       "      <td>660a36ea4969eb481653b8d4</td>\n",
       "      <td>b02bde6cefdf11eeab8c005056aed1e3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711945451</td>\n",
       "      <td>1711945451</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:24:10.934</td>\n",
       "      <td>None</td>\n",
       "      <td>\"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12198</th>\n",
       "      <td>660a34a54969eb481653aafa</td>\n",
       "      <td>54dbf28cefde11ee84fa0050568e57f7</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:14:29.160</td>\n",
       "      <td>None</td>\n",
       "      <td>\"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12199</th>\n",
       "      <td>660a34a44969eb481653aaf6</td>\n",
       "      <td>555bcc3cefde11ee82a9005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:14:28.939</td>\n",
       "      <td>None</td>\n",
       "      <td>\"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12200</th>\n",
       "      <td>660a3456ff2cdc8c811d99ea</td>\n",
       "      <td>385fcadeefde11eebe080050568eacf7</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1711944790</td>\n",
       "      <td>1711944790</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:13:10.199</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12201 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                            _id                               cid  plugin  \\\n",
       "0      66136b66ff2cdc8c8171adb9  3698400ef55c11eea80c70df2faec9db  sansay   \n",
       "1      66136ad04969eb4816301e43  e9570956f55b11ee934a0050568e39d3  sansay   \n",
       "2      66136aadff2cdc8c8171abb0  d48a5942f55b11eea7ca005056a9146f  sansay   \n",
       "3      661369924969eb481630171d  2c1e72def55b11ee92b40050568e39d3  sansay   \n",
       "4      661369904969eb481630170f  2afac18cf55b11ee92b40050568e39d3  sansay   \n",
       "...                         ...                               ...     ...   \n",
       "12196  660a38874969eb481653c1a2  a6150042efe011ee8339005056a9146f  sansay   \n",
       "12197  660a36ea4969eb481653b8d4  b02bde6cefdf11eeab8c005056aed1e3  sansay   \n",
       "12198  660a34a54969eb481653aafa  54dbf28cefde11ee84fa0050568e57f7  sansay   \n",
       "12199  660a34a44969eb481653aaf6  555bcc3cefde11ee82a9005056a9146f  sansay   \n",
       "12200  660a3456ff2cdc8c811d99ea  385fcadeefde11eebe080050568eacf7  sansay   \n",
       "\n",
       "                                               http_info  time_start  \\\n",
       "0          {'error': 'Client Error Server disconnected'}  1712548710   \n",
       "1          {'error': 'Client Error Server disconnected'}  1712548560   \n",
       "2          {'error': 'Client Error Server disconnected'}  1712548525   \n",
       "3      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548243   \n",
       "4      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548241   \n",
       "...                                                  ...         ...   \n",
       "12196  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945863   \n",
       "12197  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945451   \n",
       "12198  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
       "12199  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
       "12200      {'error': 'Client Error Server disconnected'}  1711944790   \n",
       "\n",
       "       time_stop  time_seg               date_time  \\\n",
       "0     1712548710         0 2024-04-07 23:58:30.187   \n",
       "1     1712548560         0 2024-04-07 23:56:00.132   \n",
       "2     1712548525         0 2024-04-07 23:55:25.232   \n",
       "3     1712548243         0 2024-04-07 23:50:42.699   \n",
       "4     1712548241         0 2024-04-07 23:50:40.840   \n",
       "...          ...       ...                     ...   \n",
       "12196 1711945863         0 2024-04-01 00:31:03.370   \n",
       "12197 1711945451         0 2024-04-01 00:24:10.934   \n",
       "12198 1711944869         0 2024-04-01 00:14:29.160   \n",
       "12199 1711944869         0 2024-04-01 00:14:28.939   \n",
       "12200 1711944790         0 2024-04-01 00:13:10.199   \n",
       "\n",
       "                                  error  \\\n",
       "0      Client Error Server disconnected   \n",
       "1      Client Error Server disconnected   \n",
       "2      Client Error Server disconnected   \n",
       "3                                  None   \n",
       "4                                  None   \n",
       "...                                 ...   \n",
       "12196                              None   \n",
       "12197                              None   \n",
       "12198                              None   \n",
       "12199                              None   \n",
       "12200  Client Error Server disconnected   \n",
       "\n",
       "                                                 request  \\\n",
       "0                                                    NaN   \n",
       "1                                                    NaN   \n",
       "2                                                    NaN   \n",
       "3      \"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...   \n",
       "4      \"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...   \n",
       "...                                                  ...   \n",
       "12196  \"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...   \n",
       "12197  \"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...   \n",
       "12198  \"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...   \n",
       "12199  \"{\\\"signingRequest\\\":{\\\"attest\\\":\\\"C\\\",\\\"orig\\...   \n",
       "12200                                                NaN   \n",
       "\n",
       "                                                response  status  \\\n",
       "0                                                    NaN     NaN   \n",
       "1                                                    NaN     NaN   \n",
       "2                                                    NaN     NaN   \n",
       "3      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "4      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "...                                                  ...     ...   \n",
       "12196  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12197  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12198  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12199  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12200                                                NaN     NaN   \n",
       "\n",
       "                      reason  \n",
       "0                        NaN  \n",
       "1                        NaN  \n",
       "2                        NaN  \n",
       "3      Internal Server Error  \n",
       "4      Internal Server Error  \n",
       "...                      ...  \n",
       "12196  Internal Server Error  \n",
       "12197  Internal Server Error  \n",
       "12198  Internal Server Error  \n",
       "12199  Internal Server Error  \n",
       "12200                    NaN  \n",
       "\n",
       "[12201 rows x 13 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "_id                   object\n",
       "cid                   object\n",
       "plugin                object\n",
       "http_info             object\n",
       "time_start           float64\n",
       "time_stop            float64\n",
       "time_seg             float64\n",
       "date_time     datetime64[ns]\n",
       "error                 object\n",
       "request               object\n",
       "response              object\n",
       "status               float64\n",
       "reason                object\n",
       "dtype: object"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "nan"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['request'][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "                            _id                               cid  plugin  \\\n",
      "0      66136b66ff2cdc8c8171adb9  3698400ef55c11eea80c70df2faec9db  sansay   \n",
      "1      66136ad04969eb4816301e43  e9570956f55b11ee934a0050568e39d3  sansay   \n",
      "2      66136aadff2cdc8c8171abb0  d48a5942f55b11eea7ca005056a9146f  sansay   \n",
      "3      661369924969eb481630171d  2c1e72def55b11ee92b40050568e39d3  sansay   \n",
      "4      661369904969eb481630170f  2afac18cf55b11ee92b40050568e39d3  sansay   \n",
      "...                         ...                               ...     ...   \n",
      "12196  660a38874969eb481653c1a2  a6150042efe011ee8339005056a9146f  sansay   \n",
      "12197  660a36ea4969eb481653b8d4  b02bde6cefdf11eeab8c005056aed1e3  sansay   \n",
      "12198  660a34a54969eb481653aafa  54dbf28cefde11ee84fa0050568e57f7  sansay   \n",
      "12199  660a34a44969eb481653aaf6  555bcc3cefde11ee82a9005056a9146f  sansay   \n",
      "12200  660a3456ff2cdc8c811d99ea  385fcadeefde11eebe080050568eacf7  sansay   \n",
      "\n",
      "                                               http_info  time_start  \\\n",
      "0          {'error': 'Client Error Server disconnected'}  1712548710   \n",
      "1          {'error': 'Client Error Server disconnected'}  1712548560   \n",
      "2          {'error': 'Client Error Server disconnected'}  1712548525   \n",
      "3      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548243   \n",
      "4      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548241   \n",
      "...                                                  ...         ...   \n",
      "12196  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945863   \n",
      "12197  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945451   \n",
      "12198  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
      "12199  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
      "12200      {'error': 'Client Error Server disconnected'}  1711944790   \n",
      "\n",
      "       time_stop  time_seg               date_time  \\\n",
      "0     1712548710         0 2024-04-07 23:58:30.187   \n",
      "1     1712548560         0 2024-04-07 23:56:00.132   \n",
      "2     1712548525         0 2024-04-07 23:55:25.232   \n",
      "3     1712548243         0 2024-04-07 23:50:42.699   \n",
      "4     1712548241         0 2024-04-07 23:50:40.840   \n",
      "...          ...       ...                     ...   \n",
      "12196 1711945863         0 2024-04-01 00:31:03.370   \n",
      "12197 1711945451         0 2024-04-01 00:24:10.934   \n",
      "12198 1711944869         0 2024-04-01 00:14:29.160   \n",
      "12199 1711944869         0 2024-04-01 00:14:28.939   \n",
      "12200 1711944790         0 2024-04-01 00:13:10.199   \n",
      "\n",
      "                                  error  \\\n",
      "0      Client Error Server disconnected   \n",
      "1      Client Error Server disconnected   \n",
      "2      Client Error Server disconnected   \n",
      "3                                  None   \n",
      "4                                  None   \n",
      "...                                 ...   \n",
      "12196                              None   \n",
      "12197                              None   \n",
      "12198                              None   \n",
      "12199                              None   \n",
      "12200  Client Error Server disconnected   \n",
      "\n",
      "                                                 request  \\\n",
      "0                                                    NaN   \n",
      "1                                                    NaN   \n",
      "2                                                    NaN   \n",
      "3      {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
      "4      {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
      "...                                                  ...   \n",
      "12196  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
      "12197  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
      "12198  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
      "12199  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
      "12200                                                NaN   \n",
      "\n",
      "                                                response  status  \\\n",
      "0                                                    NaN     NaN   \n",
      "1                                                    NaN     NaN   \n",
      "2                                                    NaN     NaN   \n",
      "3      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
      "4      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
      "...                                                  ...     ...   \n",
      "12196  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
      "12197  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
      "12198  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
      "12199  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
      "12200                                                NaN     NaN   \n",
      "\n",
      "                      reason signingRequest.attest signingRequest.orig.tn  \\\n",
      "0                        NaN                   NaN                    NaN   \n",
      "1                        NaN                   NaN                    NaN   \n",
      "2                        NaN                   NaN                    NaN   \n",
      "3      Internal Server Error                     C                   +100   \n",
      "4      Internal Server Error                     C                   +100   \n",
      "...                      ...                   ...                    ...   \n",
      "12196  Internal Server Error                     C                          \n",
      "12197  Internal Server Error                     C                          \n",
      "12198  Internal Server Error                     C           +19173648970   \n",
      "12199  Internal Server Error                     C           +19173648970   \n",
      "12200                    NaN                   NaN                    NaN   \n",
      "\n",
      "      signingRequest.dest.tn  signingRequest.iat  \\\n",
      "0                        NaN                 NaN   \n",
      "1                        NaN                 NaN   \n",
      "2                        NaN                 NaN   \n",
      "3              [17542699818]          1712548242   \n",
      "4              [17542699818]          1712548240   \n",
      "...                      ...                 ...   \n",
      "12196          [15015179729]          1711945863   \n",
      "12197          [14702698656]          1711945450   \n",
      "12198     [1019#18445139771]          1711944869   \n",
      "12199     [1019#18445139771]          1711944868   \n",
      "12200                    NaN                 NaN   \n",
      "\n",
      "                  signingRequest.origid  \n",
      "0                                   NaN  \n",
      "1                                   NaN  \n",
      "2                                   NaN  \n",
      "3      2c1e72def55b11ee92b40050568e39d3  \n",
      "4      2afac18cf55b11ee92b40050568e39d3  \n",
      "...                                 ...  \n",
      "12196  a6150042efe011ee8339005056a9146f  \n",
      "12197  b02bde6cefdf11eeab8c005056aed1e3  \n",
      "12198  54dbf28cefde11ee84fa0050568e57f7  \n",
      "12199  555bcc3cefde11ee82a9005056a9146f  \n",
      "12200                               NaN  \n",
      "\n",
      "[12201 rows x 18 columns]\n"
     ]
    }
   ],
   "source": [
    "def decode_backslashes(json_str):\n",
    "    if isinstance(json_str, str):\n",
    "        # Remove the extra double quotes surrounding the JSON string\n",
    "        json_str = json_str[1:-1]\n",
    "        return json.loads(json_str.replace('\\\\', ''))\n",
    "    else:\n",
    "        return json_str\n",
    "\n",
    "\n",
    "\n",
    "df['request'] = df['request'].apply(decode_backslashes)\n",
    "\n",
    "df_normalized = pd.json_normalize(df['request'])\n",
    "\n",
    "\n",
    "df = pd.concat([df, df_normalized], axis=1)\n",
    "\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>signingRequest.attest</th>\n",
       "      <th>signingRequest.orig.tn</th>\n",
       "      <th>signingRequest.dest.tn</th>\n",
       "      <th>signingRequest.iat</th>\n",
       "      <th>signingRequest.origid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>C</td>\n",
       "      <td>+100</td>\n",
       "      <td>[17542699818]</td>\n",
       "      <td>1712548242</td>\n",
       "      <td>2c1e72def55b11ee92b40050568e39d3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>C</td>\n",
       "      <td>+100</td>\n",
       "      <td>[17542699818]</td>\n",
       "      <td>1712548240</td>\n",
       "      <td>2afac18cf55b11ee92b40050568e39d3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12196</th>\n",
       "      <td>C</td>\n",
       "      <td></td>\n",
       "      <td>[15015179729]</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>a6150042efe011ee8339005056a9146f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12197</th>\n",
       "      <td>C</td>\n",
       "      <td></td>\n",
       "      <td>[14702698656]</td>\n",
       "      <td>1711945450</td>\n",
       "      <td>b02bde6cefdf11eeab8c005056aed1e3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12198</th>\n",
       "      <td>C</td>\n",
       "      <td>+19173648970</td>\n",
       "      <td>[1019#18445139771]</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>54dbf28cefde11ee84fa0050568e57f7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12199</th>\n",
       "      <td>C</td>\n",
       "      <td>+19173648970</td>\n",
       "      <td>[1019#18445139771]</td>\n",
       "      <td>1711944868</td>\n",
       "      <td>555bcc3cefde11ee82a9005056a9146f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12200</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12201 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      signingRequest.attest signingRequest.orig.tn signingRequest.dest.tn  \\\n",
       "0                       NaN                    NaN                    NaN   \n",
       "1                       NaN                    NaN                    NaN   \n",
       "2                       NaN                    NaN                    NaN   \n",
       "3                         C                   +100          [17542699818]   \n",
       "4                         C                   +100          [17542699818]   \n",
       "...                     ...                    ...                    ...   \n",
       "12196                     C                                 [15015179729]   \n",
       "12197                     C                                 [14702698656]   \n",
       "12198                     C           +19173648970     [1019#18445139771]   \n",
       "12199                     C           +19173648970     [1019#18445139771]   \n",
       "12200                   NaN                    NaN                    NaN   \n",
       "\n",
       "       signingRequest.iat             signingRequest.origid  \n",
       "0                     NaN                               NaN  \n",
       "1                     NaN                               NaN  \n",
       "2                     NaN                               NaN  \n",
       "3              1712548242  2c1e72def55b11ee92b40050568e39d3  \n",
       "4              1712548240  2afac18cf55b11ee92b40050568e39d3  \n",
       "...                   ...                               ...  \n",
       "12196          1711945863  a6150042efe011ee8339005056a9146f  \n",
       "12197          1711945450  b02bde6cefdf11eeab8c005056aed1e3  \n",
       "12198          1711944869  54dbf28cefde11ee84fa0050568e57f7  \n",
       "12199          1711944868  555bcc3cefde11ee82a9005056a9146f  \n",
       "12200                 NaN                               NaN  \n",
       "\n",
       "[12201 rows x 5 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_normalized"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>_id</th>\n",
       "      <th>cid</th>\n",
       "      <th>plugin</th>\n",
       "      <th>http_info</th>\n",
       "      <th>time_start</th>\n",
       "      <th>time_stop</th>\n",
       "      <th>time_seg</th>\n",
       "      <th>date_time</th>\n",
       "      <th>error</th>\n",
       "      <th>request</th>\n",
       "      <th>response</th>\n",
       "      <th>status</th>\n",
       "      <th>reason</th>\n",
       "      <th>signingRequest.attest</th>\n",
       "      <th>signingRequest.orig.tn</th>\n",
       "      <th>signingRequest.dest.tn</th>\n",
       "      <th>signingRequest.iat</th>\n",
       "      <th>signingRequest.origid</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>66136b66ff2cdc8c8171adb9</td>\n",
       "      <td>3698400ef55c11eea80c70df2faec9db</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548710</td>\n",
       "      <td>1712548710</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:58:30.187</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>66136ad04969eb4816301e43</td>\n",
       "      <td>e9570956f55b11ee934a0050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548560</td>\n",
       "      <td>1712548560</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:56:00.132</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>66136aadff2cdc8c8171abb0</td>\n",
       "      <td>d48a5942f55b11eea7ca005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548525</td>\n",
       "      <td>1712548525</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:55:25.232</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>661369924969eb481630171d</td>\n",
       "      <td>2c1e72def55b11ee92b40050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1712548243</td>\n",
       "      <td>1712548243</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:50:42.699</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+100</td>\n",
       "      <td>[17542699818]</td>\n",
       "      <td>1712548242</td>\n",
       "      <td>2c1e72def55b11ee92b40050568e39d3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>661369904969eb481630170f</td>\n",
       "      <td>2afac18cf55b11ee92b40050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1712548241</td>\n",
       "      <td>1712548241</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:50:40.840</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+100</td>\n",
       "      <td>[17542699818]</td>\n",
       "      <td>1712548240</td>\n",
       "      <td>2afac18cf55b11ee92b40050568e39d3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12196</th>\n",
       "      <td>660a38874969eb481653c1a2</td>\n",
       "      <td>a6150042efe011ee8339005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:31:03.370</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td></td>\n",
       "      <td>[15015179729]</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>a6150042efe011ee8339005056a9146f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12197</th>\n",
       "      <td>660a36ea4969eb481653b8d4</td>\n",
       "      <td>b02bde6cefdf11eeab8c005056aed1e3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711945451</td>\n",
       "      <td>1711945451</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:24:10.934</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td></td>\n",
       "      <td>[14702698656]</td>\n",
       "      <td>1711945450</td>\n",
       "      <td>b02bde6cefdf11eeab8c005056aed1e3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12198</th>\n",
       "      <td>660a34a54969eb481653aafa</td>\n",
       "      <td>54dbf28cefde11ee84fa0050568e57f7</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:14:29.160</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+19173648970</td>\n",
       "      <td>[1019#18445139771]</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>54dbf28cefde11ee84fa0050568e57f7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12199</th>\n",
       "      <td>660a34a44969eb481653aaf6</td>\n",
       "      <td>555bcc3cefde11ee82a9005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:14:28.939</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+19173648970</td>\n",
       "      <td>[1019#18445139771]</td>\n",
       "      <td>1711944868</td>\n",
       "      <td>555bcc3cefde11ee82a9005056a9146f</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12200</th>\n",
       "      <td>660a3456ff2cdc8c811d99ea</td>\n",
       "      <td>385fcadeefde11eebe080050568eacf7</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1711944790</td>\n",
       "      <td>1711944790</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:13:10.199</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12201 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                            _id                               cid  plugin  \\\n",
       "0      66136b66ff2cdc8c8171adb9  3698400ef55c11eea80c70df2faec9db  sansay   \n",
       "1      66136ad04969eb4816301e43  e9570956f55b11ee934a0050568e39d3  sansay   \n",
       "2      66136aadff2cdc8c8171abb0  d48a5942f55b11eea7ca005056a9146f  sansay   \n",
       "3      661369924969eb481630171d  2c1e72def55b11ee92b40050568e39d3  sansay   \n",
       "4      661369904969eb481630170f  2afac18cf55b11ee92b40050568e39d3  sansay   \n",
       "...                         ...                               ...     ...   \n",
       "12196  660a38874969eb481653c1a2  a6150042efe011ee8339005056a9146f  sansay   \n",
       "12197  660a36ea4969eb481653b8d4  b02bde6cefdf11eeab8c005056aed1e3  sansay   \n",
       "12198  660a34a54969eb481653aafa  54dbf28cefde11ee84fa0050568e57f7  sansay   \n",
       "12199  660a34a44969eb481653aaf6  555bcc3cefde11ee82a9005056a9146f  sansay   \n",
       "12200  660a3456ff2cdc8c811d99ea  385fcadeefde11eebe080050568eacf7  sansay   \n",
       "\n",
       "                                               http_info  time_start  \\\n",
       "0          {'error': 'Client Error Server disconnected'}  1712548710   \n",
       "1          {'error': 'Client Error Server disconnected'}  1712548560   \n",
       "2          {'error': 'Client Error Server disconnected'}  1712548525   \n",
       "3      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548243   \n",
       "4      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548241   \n",
       "...                                                  ...         ...   \n",
       "12196  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945863   \n",
       "12197  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945451   \n",
       "12198  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
       "12199  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
       "12200      {'error': 'Client Error Server disconnected'}  1711944790   \n",
       "\n",
       "       time_stop  time_seg               date_time  \\\n",
       "0     1712548710         0 2024-04-07 23:58:30.187   \n",
       "1     1712548560         0 2024-04-07 23:56:00.132   \n",
       "2     1712548525         0 2024-04-07 23:55:25.232   \n",
       "3     1712548243         0 2024-04-07 23:50:42.699   \n",
       "4     1712548241         0 2024-04-07 23:50:40.840   \n",
       "...          ...       ...                     ...   \n",
       "12196 1711945863         0 2024-04-01 00:31:03.370   \n",
       "12197 1711945451         0 2024-04-01 00:24:10.934   \n",
       "12198 1711944869         0 2024-04-01 00:14:29.160   \n",
       "12199 1711944869         0 2024-04-01 00:14:28.939   \n",
       "12200 1711944790         0 2024-04-01 00:13:10.199   \n",
       "\n",
       "                                  error  \\\n",
       "0      Client Error Server disconnected   \n",
       "1      Client Error Server disconnected   \n",
       "2      Client Error Server disconnected   \n",
       "3                                  None   \n",
       "4                                  None   \n",
       "...                                 ...   \n",
       "12196                              None   \n",
       "12197                              None   \n",
       "12198                              None   \n",
       "12199                              None   \n",
       "12200  Client Error Server disconnected   \n",
       "\n",
       "                                                 request  \\\n",
       "0                                                    NaN   \n",
       "1                                                    NaN   \n",
       "2                                                    NaN   \n",
       "3      {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "4      {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "...                                                  ...   \n",
       "12196  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12197  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12198  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12199  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12200                                                NaN   \n",
       "\n",
       "                                                response  status  \\\n",
       "0                                                    NaN     NaN   \n",
       "1                                                    NaN     NaN   \n",
       "2                                                    NaN     NaN   \n",
       "3      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "4      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "...                                                  ...     ...   \n",
       "12196  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12197  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12198  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12199  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12200                                                NaN     NaN   \n",
       "\n",
       "                      reason signingRequest.attest signingRequest.orig.tn  \\\n",
       "0                        NaN                   NaN                    NaN   \n",
       "1                        NaN                   NaN                    NaN   \n",
       "2                        NaN                   NaN                    NaN   \n",
       "3      Internal Server Error                     C                   +100   \n",
       "4      Internal Server Error                     C                   +100   \n",
       "...                      ...                   ...                    ...   \n",
       "12196  Internal Server Error                     C                          \n",
       "12197  Internal Server Error                     C                          \n",
       "12198  Internal Server Error                     C           +19173648970   \n",
       "12199  Internal Server Error                     C           +19173648970   \n",
       "12200                    NaN                   NaN                    NaN   \n",
       "\n",
       "      signingRequest.dest.tn  signingRequest.iat  \\\n",
       "0                        NaN                 NaN   \n",
       "1                        NaN                 NaN   \n",
       "2                        NaN                 NaN   \n",
       "3              [17542699818]          1712548242   \n",
       "4              [17542699818]          1712548240   \n",
       "...                      ...                 ...   \n",
       "12196          [15015179729]          1711945863   \n",
       "12197          [14702698656]          1711945450   \n",
       "12198     [1019#18445139771]          1711944869   \n",
       "12199     [1019#18445139771]          1711944868   \n",
       "12200                    NaN                 NaN   \n",
       "\n",
       "                  signingRequest.origid  \n",
       "0                                   NaN  \n",
       "1                                   NaN  \n",
       "2                                   NaN  \n",
       "3      2c1e72def55b11ee92b40050568e39d3  \n",
       "4      2afac18cf55b11ee92b40050568e39d3  \n",
       "...                                 ...  \n",
       "12196  a6150042efe011ee8339005056a9146f  \n",
       "12197  b02bde6cefdf11eeab8c005056aed1e3  \n",
       "12198  54dbf28cefde11ee84fa0050568e57f7  \n",
       "12199  555bcc3cefde11ee82a9005056a9146f  \n",
       "12200                               NaN  \n",
       "\n",
       "[12201 rows x 18 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "def extract_number(dest_tn):\n",
    "    try:\n",
    "        \n",
    "        if isinstance(dest_tn, list) and dest_tn:\n",
    "            return dest_tn[0]\n",
    "        else:\n",
    "            return np.nan\n",
    "    except (TypeError, IndexError):\n",
    "        return np.nan\n",
    "\n",
    "\n",
    "df['extracted_number'] = df['request'].apply(lambda x: extract_number(x.get('signingRequest', {}).get('dest', {}).get('tn', [])) if x is not np.nan else np.nan)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>_id</th>\n",
       "      <th>cid</th>\n",
       "      <th>plugin</th>\n",
       "      <th>http_info</th>\n",
       "      <th>time_start</th>\n",
       "      <th>time_stop</th>\n",
       "      <th>time_seg</th>\n",
       "      <th>date_time</th>\n",
       "      <th>error</th>\n",
       "      <th>request</th>\n",
       "      <th>response</th>\n",
       "      <th>status</th>\n",
       "      <th>reason</th>\n",
       "      <th>signingRequest.attest</th>\n",
       "      <th>signingRequest.orig.tn</th>\n",
       "      <th>signingRequest.dest.tn</th>\n",
       "      <th>signingRequest.iat</th>\n",
       "      <th>signingRequest.origid</th>\n",
       "      <th>extracted_number</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>66136b66ff2cdc8c8171adb9</td>\n",
       "      <td>3698400ef55c11eea80c70df2faec9db</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548710</td>\n",
       "      <td>1712548710</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:58:30.187</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>66136ad04969eb4816301e43</td>\n",
       "      <td>e9570956f55b11ee934a0050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548560</td>\n",
       "      <td>1712548560</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:56:00.132</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>66136aadff2cdc8c8171abb0</td>\n",
       "      <td>d48a5942f55b11eea7ca005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1712548525</td>\n",
       "      <td>1712548525</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:55:25.232</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>661369924969eb481630171d</td>\n",
       "      <td>2c1e72def55b11ee92b40050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1712548243</td>\n",
       "      <td>1712548243</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:50:42.699</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+100</td>\n",
       "      <td>[17542699818]</td>\n",
       "      <td>1712548242</td>\n",
       "      <td>2c1e72def55b11ee92b40050568e39d3</td>\n",
       "      <td>17542699818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>661369904969eb481630170f</td>\n",
       "      <td>2afac18cf55b11ee92b40050568e39d3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1712548241</td>\n",
       "      <td>1712548241</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-07 23:50:40.840</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+100</td>\n",
       "      <td>[17542699818]</td>\n",
       "      <td>1712548240</td>\n",
       "      <td>2afac18cf55b11ee92b40050568e39d3</td>\n",
       "      <td>17542699818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12196</th>\n",
       "      <td>660a38874969eb481653c1a2</td>\n",
       "      <td>a6150042efe011ee8339005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:31:03.370</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td></td>\n",
       "      <td>[15015179729]</td>\n",
       "      <td>1711945863</td>\n",
       "      <td>a6150042efe011ee8339005056a9146f</td>\n",
       "      <td>15015179729</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12197</th>\n",
       "      <td>660a36ea4969eb481653b8d4</td>\n",
       "      <td>b02bde6cefdf11eeab8c005056aed1e3</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711945451</td>\n",
       "      <td>1711945451</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:24:10.934</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td></td>\n",
       "      <td>[14702698656]</td>\n",
       "      <td>1711945450</td>\n",
       "      <td>b02bde6cefdf11eeab8c005056aed1e3</td>\n",
       "      <td>14702698656</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12198</th>\n",
       "      <td>660a34a54969eb481653aafa</td>\n",
       "      <td>54dbf28cefde11ee84fa0050568e57f7</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:14:29.160</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+19173648970</td>\n",
       "      <td>[1019#18445139771]</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>54dbf28cefde11ee84fa0050568e57f7</td>\n",
       "      <td>1019#18445139771</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12199</th>\n",
       "      <td>660a34a44969eb481653aaf6</td>\n",
       "      <td>555bcc3cefde11ee82a9005056a9146f</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>1711944869</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:14:28.939</td>\n",
       "      <td>None</td>\n",
       "      <td>{'signingRequest': {'attest': 'C', 'orig': {'t...</td>\n",
       "      <td>{\"requestError\":{\"serviceException\":{\"messageI...</td>\n",
       "      <td>500</td>\n",
       "      <td>Internal Server Error</td>\n",
       "      <td>C</td>\n",
       "      <td>+19173648970</td>\n",
       "      <td>[1019#18445139771]</td>\n",
       "      <td>1711944868</td>\n",
       "      <td>555bcc3cefde11ee82a9005056a9146f</td>\n",
       "      <td>1019#18445139771</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12200</th>\n",
       "      <td>660a3456ff2cdc8c811d99ea</td>\n",
       "      <td>385fcadeefde11eebe080050568eacf7</td>\n",
       "      <td>sansay</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "      <td>1711944790</td>\n",
       "      <td>1711944790</td>\n",
       "      <td>0</td>\n",
       "      <td>2024-04-01 00:13:10.199</td>\n",
       "      <td>Client Error Server disconnected</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>12201 rows × 19 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                            _id                               cid  plugin  \\\n",
       "0      66136b66ff2cdc8c8171adb9  3698400ef55c11eea80c70df2faec9db  sansay   \n",
       "1      66136ad04969eb4816301e43  e9570956f55b11ee934a0050568e39d3  sansay   \n",
       "2      66136aadff2cdc8c8171abb0  d48a5942f55b11eea7ca005056a9146f  sansay   \n",
       "3      661369924969eb481630171d  2c1e72def55b11ee92b40050568e39d3  sansay   \n",
       "4      661369904969eb481630170f  2afac18cf55b11ee92b40050568e39d3  sansay   \n",
       "...                         ...                               ...     ...   \n",
       "12196  660a38874969eb481653c1a2  a6150042efe011ee8339005056a9146f  sansay   \n",
       "12197  660a36ea4969eb481653b8d4  b02bde6cefdf11eeab8c005056aed1e3  sansay   \n",
       "12198  660a34a54969eb481653aafa  54dbf28cefde11ee84fa0050568e57f7  sansay   \n",
       "12199  660a34a44969eb481653aaf6  555bcc3cefde11ee82a9005056a9146f  sansay   \n",
       "12200  660a3456ff2cdc8c811d99ea  385fcadeefde11eebe080050568eacf7  sansay   \n",
       "\n",
       "                                               http_info  time_start  \\\n",
       "0          {'error': 'Client Error Server disconnected'}  1712548710   \n",
       "1          {'error': 'Client Error Server disconnected'}  1712548560   \n",
       "2          {'error': 'Client Error Server disconnected'}  1712548525   \n",
       "3      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548243   \n",
       "4      {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1712548241   \n",
       "...                                                  ...         ...   \n",
       "12196  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945863   \n",
       "12197  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711945451   \n",
       "12198  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
       "12199  {'request': '\"{\\\"signingRequest\\\":{\\\"attest\\\":...  1711944869   \n",
       "12200      {'error': 'Client Error Server disconnected'}  1711944790   \n",
       "\n",
       "       time_stop  time_seg               date_time  \\\n",
       "0     1712548710         0 2024-04-07 23:58:30.187   \n",
       "1     1712548560         0 2024-04-07 23:56:00.132   \n",
       "2     1712548525         0 2024-04-07 23:55:25.232   \n",
       "3     1712548243         0 2024-04-07 23:50:42.699   \n",
       "4     1712548241         0 2024-04-07 23:50:40.840   \n",
       "...          ...       ...                     ...   \n",
       "12196 1711945863         0 2024-04-01 00:31:03.370   \n",
       "12197 1711945451         0 2024-04-01 00:24:10.934   \n",
       "12198 1711944869         0 2024-04-01 00:14:29.160   \n",
       "12199 1711944869         0 2024-04-01 00:14:28.939   \n",
       "12200 1711944790         0 2024-04-01 00:13:10.199   \n",
       "\n",
       "                                  error  \\\n",
       "0      Client Error Server disconnected   \n",
       "1      Client Error Server disconnected   \n",
       "2      Client Error Server disconnected   \n",
       "3                                  None   \n",
       "4                                  None   \n",
       "...                                 ...   \n",
       "12196                              None   \n",
       "12197                              None   \n",
       "12198                              None   \n",
       "12199                              None   \n",
       "12200  Client Error Server disconnected   \n",
       "\n",
       "                                                 request  \\\n",
       "0                                                    NaN   \n",
       "1                                                    NaN   \n",
       "2                                                    NaN   \n",
       "3      {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "4      {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "...                                                  ...   \n",
       "12196  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12197  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12198  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12199  {'signingRequest': {'attest': 'C', 'orig': {'t...   \n",
       "12200                                                NaN   \n",
       "\n",
       "                                                response  status  \\\n",
       "0                                                    NaN     NaN   \n",
       "1                                                    NaN     NaN   \n",
       "2                                                    NaN     NaN   \n",
       "3      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "4      {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "...                                                  ...     ...   \n",
       "12196  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12197  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12198  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12199  {\"requestError\":{\"serviceException\":{\"messageI...     500   \n",
       "12200                                                NaN     NaN   \n",
       "\n",
       "                      reason signingRequest.attest signingRequest.orig.tn  \\\n",
       "0                        NaN                   NaN                    NaN   \n",
       "1                        NaN                   NaN                    NaN   \n",
       "2                        NaN                   NaN                    NaN   \n",
       "3      Internal Server Error                     C                   +100   \n",
       "4      Internal Server Error                     C                   +100   \n",
       "...                      ...                   ...                    ...   \n",
       "12196  Internal Server Error                     C                          \n",
       "12197  Internal Server Error                     C                          \n",
       "12198  Internal Server Error                     C           +19173648970   \n",
       "12199  Internal Server Error                     C           +19173648970   \n",
       "12200                    NaN                   NaN                    NaN   \n",
       "\n",
       "      signingRequest.dest.tn  signingRequest.iat  \\\n",
       "0                        NaN                 NaN   \n",
       "1                        NaN                 NaN   \n",
       "2                        NaN                 NaN   \n",
       "3              [17542699818]          1712548242   \n",
       "4              [17542699818]          1712548240   \n",
       "...                      ...                 ...   \n",
       "12196          [15015179729]          1711945863   \n",
       "12197          [14702698656]          1711945450   \n",
       "12198     [1019#18445139771]          1711944869   \n",
       "12199     [1019#18445139771]          1711944868   \n",
       "12200                    NaN                 NaN   \n",
       "\n",
       "                  signingRequest.origid  extracted_number  \n",
       "0                                   NaN               NaN  \n",
       "1                                   NaN               NaN  \n",
       "2                                   NaN               NaN  \n",
       "3      2c1e72def55b11ee92b40050568e39d3       17542699818  \n",
       "4      2afac18cf55b11ee92b40050568e39d3       17542699818  \n",
       "...                                 ...               ...  \n",
       "12196  a6150042efe011ee8339005056a9146f       15015179729  \n",
       "12197  b02bde6cefdf11eeab8c005056aed1e3       14702698656  \n",
       "12198  54dbf28cefde11ee84fa0050568e57f7  1019#18445139771  \n",
       "12199  555bcc3cefde11ee82a9005056a9146f  1019#18445139771  \n",
       "12200                               NaN               NaN  \n",
       "\n",
       "[12201 rows x 19 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "list2=df[['request','http_info']][df['request'].isna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>request</th>\n",
       "      <th>http_info</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12189</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12190</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12192</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12193</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12200</th>\n",
       "      <td>NaN</td>\n",
       "      <td>{'error': 'Client Error Server disconnected'}</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>921 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      request                                      http_info\n",
       "0         NaN  {'error': 'Client Error Server disconnected'}\n",
       "1         NaN  {'error': 'Client Error Server disconnected'}\n",
       "2         NaN  {'error': 'Client Error Server disconnected'}\n",
       "11        NaN  {'error': 'Client Error Server disconnected'}\n",
       "13        NaN  {'error': 'Client Error Server disconnected'}\n",
       "...       ...                                            ...\n",
       "12189     NaN  {'error': 'Client Error Server disconnected'}\n",
       "12190     NaN  {'error': 'Client Error Server disconnected'}\n",
       "12192     NaN  {'error': 'Client Error Server disconnected'}\n",
       "12193     NaN  {'error': 'Client Error Server disconnected'}\n",
       "12200     NaN  {'error': 'Client Error Server disconnected'}\n",
       "\n",
       "[921 rows x 2 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>request</th>\n",
       "      <th>http_info</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>http_info</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>{'error': 'Client Error '}</th>\n",
       "      <td>0</td>\n",
       "      <td>134</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>{'error': 'Client Error Server disconnected'}</th>\n",
       "      <td>0</td>\n",
       "      <td>762</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>{'error': 'Client Error [Errno 104] Connection reset by peer'}</th>\n",
       "      <td>0</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>{'error': 'Client Error [Errno None] Can not write request body for https://identidad-nss-ha.sansay.com:3334/stir/v1/signing'}</th>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                    request  http_info\n",
       "http_info                                                             \n",
       "{'error': 'Client Error '}                                0        134\n",
       "{'error': 'Client Error Server disconnected'}             0        762\n",
       "{'error': 'Client Error [Errno 104] Connection ...        0         18\n",
       "{'error': 'Client Error [Errno None] Can not wr...        0          7"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list2.groupby(list2['http_info'].astype(str)).count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "server_name = 'identidadvoip.database.windows.net'\n",
    "database_name = 'ApolloProdDb'\n",
    "username = 'mfvilla'\n",
    "password = 'aQ-ATd5Kk-NgVfD'\n",
    "\n",
    "\n",
    "\n",
    "connection_string = f'DRIVER={{ODBC Driver 17 for SQL Server}};SERVER={server_name};DATABASE={database_name};UID={username};PWD={password};LOGIN_TIMEOUT=30'\n",
    "connection = pyodbc.connect(connection_string)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "ename": "OperationalError",
     "evalue": "('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mOperationalError\u001b[0m                          Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[20], line 9\u001b[0m\n\u001b[1;32m      4\u001b[0m password \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124maQ-ATd5Kk-NgVfD\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m      8\u001b[0m connection_string \u001b[38;5;241m=\u001b[39m \u001b[38;5;124mf\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDRIVER=\u001b[39m\u001b[38;5;130;01m{{\u001b[39;00m\u001b[38;5;124mODBC Driver 17 for SQL Server\u001b[39m\u001b[38;5;130;01m}}\u001b[39;00m\u001b[38;5;124m;SERVER=\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mserver_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m;DATABASE=\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mdatabase_name\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m;UID=\u001b[39m\u001b[38;5;132;01m{\u001b[39;00musername\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m;PWD=\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mpassword\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m;LOGIN_TIMEOUT=30\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m----> 9\u001b[0m connection \u001b[38;5;241m=\u001b[39m pyodbc\u001b[38;5;241m.\u001b[39mconnect(connection_string)\n\u001b[1;32m     14\u001b[0m query\u001b[38;5;241m=\u001b[39m \u001b[38;5;124m\"\"\"\u001b[39m\n\u001b[1;32m     15\u001b[0m \u001b[38;5;124mSELECT CDR.[CdrId]\u001b[39m\n\u001b[1;32m     16\u001b[0m \u001b[38;5;124m      ,CDR.[DateCall]\u001b[39m\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m     62\u001b[0m \u001b[38;5;124m  AND CDR.DateCall < \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m2024-04-02 00:00:00\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m \u001b[39m\n\u001b[1;32m     63\u001b[0m \u001b[38;5;124m\"\"\"\u001b[39m\n\u001b[1;32m     65\u001b[0m df_mera \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_sql_query(query, connection)\n",
      "\u001b[0;31mOperationalError\u001b[0m: ('HYT00', '[HYT00] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0) (SQLDriverConnect)')"
     ]
    }
   ],
   "source": [
    "server_name = 'identidadvoip.database.windows.net'\n",
    "database_name = 'ApolloProdDb'\n",
    "username = 'mfvilla'\n",
    "password = 'aQ-ATd5Kk-NgVfD'\n",
    "\n",
    "\n",
    "\n",
    "connection_string = f'DRIVER={{ODBC Driver 17 for SQL Server}};SERVER={server_name};DATABASE={database_name};UID={username};PWD={password};LOGIN_TIMEOUT=30'\n",
    "connection = pyodbc.connect(connection_string)\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "query= \"\"\"\n",
    "SELECT CDR.[CdrId]\n",
    "      ,CDR.[DateCall]\n",
    "      ,CDR.[SettlementPrice]\n",
    "      ,CDR.[SettlementCost]\n",
    "      ,CDR.[Vendor]\n",
    "      ,VE.ContrName VendorName\n",
    "      ,CDR.[Client]\n",
    "      ,CL.ContrName ClientName\n",
    "      ,CDR.[AreaNameId]\n",
    "      ,AR.CallRoute Area\n",
    "      ,CDR.[TotalSeconds]\n",
    "      ,CDR.[RpServId]\n",
    "      ,CDR.[PrefixDescriptionDp]\n",
    "      ,CDR.[DstBiltime]\n",
    "      ,CDR.[DstBillCostAccountCur]\n",
    "      ,CDR.[SrcBillCostSrcAccountCur]\n",
    "      ,CDR.[DpBillScheme]\n",
    "      ,CDR.[RpBillScheme]\n",
    "      ,CDR.[ElapsedTime]\n",
    "      ,CDR.[SrcAddress]\n",
    "      ,CDR.[DstAddress]\n",
    "      ,CDR.[SrcNumberIn]\n",
    "      ,CDR.[DstNumberIn]\n",
    "      ,CDR.[SrcNumberRoute]\n",
    "      ,CDR.[DstNumberRoute]\n",
    "      ,CDR.[SrcNumberOut]\n",
    "      ,CDR.[DstNumberOut]\n",
    "      ,CDR.[SrcSetupTime]\n",
    "      ,CDR.[DstSetupTime]\n",
    "      ,CDR.[SrcAlertingTime]\n",
    "      ,CDR.[DstAlertingTime]\n",
    "      ,CDR.[ConnectTime]\n",
    "      ,CDR.[DisconnectTime]\n",
    "      ,CDR.[DisconnectCode]\n",
    "      ,CDR.[SrcDisconnectCode]\n",
    "      ,CDR.[DstDisconnectCode]\n",
    "      ,CDR.[AreaPrfx]\n",
    "      ,CDR.[TechPrfx]\n",
    "      ,CDR.[DstId]\n",
    "      ,CDR.[DpPrfx]\n",
    "      ,CDR.[DpRateDstAccountCur]\n",
    "      ,CDR.[Lrn]\n",
    "  FROM [dbo].[CdrBilled] CDR\n",
    "  JOIN Contractors CL ON CDR.Client = CL.ContractorId\n",
    "  JOIN Contractors VE ON CDR.Vendor = VE.ContractorId\n",
    "  JOIN AreaNames AR ON CDR.AreaNameId = AR.AreaNameId\n",
    "  WHERE CDR.DateCall >= '2024-04-01 00:00:00'\n",
    "  AND CDR.DateCall < '2024-04-02 00:00:00' \n",
    "\"\"\"\n",
    "\n",
    "df_mera = pd.read_sql_query(query, connection)\n",
    "\n",
    "\n",
    "connection.close()\n",
    "\n",
    "\n",
    "df_mera"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
